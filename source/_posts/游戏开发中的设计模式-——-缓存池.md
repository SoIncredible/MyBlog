---
title: 游戏开发中的设计模式 —— 缓存池
abbrlink: c41139c9
date: 2024-08-13 10:38:40
tags: 设计模式
categories:
cover: https://www.notion.so/images/page-cover/met_klimt_1912.jpg
description:
swiper_index:
sticky:
---

在阅读UGUI源码的时候, 频繁地使用了Unity的ListPool结构:

```C#
private static void GetEventList<T>(GameObject go, IList<IEventSystemHandler> results) where T : IEventSystemHandler
{
    // Debug.LogWarning("GetEventList<" + typeof(T).Name + ">");
    if (results == null)
        throw new ArgumentException("Results array is null", "results");

    if (go == null || !go.activeInHierarchy)
        return;

    var components = ListPool<Component>.Get();
    go.GetComponents(components);

    var componentsCount = components.Count;
    for (var i = 0; i < componentsCount; i++)
    {
        if (!ShouldSendToComponent<T>(components[i]))
            continue;

        // Debug.Log(string.Format("{2} found! On {0}.{1}", go, s_GetComponentsScratch[i].GetType(), typeof(T)));
        results.Add(components[i] as IEventSystemHandler);
    }
    ListPool<Component>.Release(components);
    // Debug.LogWarning("end GetEventList<" + typeof(T).Name + ">");
}
```

当你想要在业务逻辑中创建新的List的时候, 不妨想一想是否可以用缓存池来代替创建新的List.