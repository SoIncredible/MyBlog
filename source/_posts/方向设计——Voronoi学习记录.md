---
title: 方向设计——Voronoi学习记录
abbrlink: 714d4a3
date: 2022-12-24 18:12:09
tags:
updated:
top_img:
categories:
cover:
description:
---

# 问题描述：

快速高效地实现虚拟世界的大规模场景布局在游戏领域中具有广泛的应用价值，因此研究空间布局的自动生成以替代传统手动建模也成为迫切需求。本课题基于Power图，兼顾自动化设计与用户设计控制，研究高效的室内空间布局生成算法，设计并实现基于Power图的室内空间布局系统。实现要求：（1）通过文献调研，了解住室内空间布局问题；（2）通过文献调研，了解Power图的基本概念和基本算法；（3）设计并实现基于Power图的室内空间布局系统。参考文献：Zheng L, Yao Y, Wu W, et al. A novel computation method of hybrid capacity constrained centroidal power diagram[J]. Computers & Graphics, 2021, 97: 108-116.









Voronoi图简介

计算几何中,Voronoi图是一种基本的数据结构,是由相邻两点连线的垂直平分线组成的凸多边形.假设问题域存在n个不重复的站点(site),按照最邻近原则划分该区域,则可将问题域划分成n份.划分成的区域为无界区域或者为有界凸多边形.每个站点在其所辖区域的内部,且多边形中任何一点到该站点的欧式距离都小于到其他点的欧式距离.具体的数学定义如下:已知二维欧式空间中的站点集X={xi|i=1,2,...,n},对于任意xi,xj属于X,所有到xi的欧式距离小于等于到xj的欧氏距离的点组成的集合记为:





Power图

power图作文Voronoi图的扩展,可以理解为带权的Voronoi图,已知二维欧式空间中的点集

Power图的性质



# 解决办法

因为最近在学习前端的知识,所以本次课设决定使用JS来完成,先来到这个[网站](https://rosettacode.org/wiki/Voronoi_diagram#JavaScript)上面,这里有JS生成Voronoi图的源码,







以下是我及其蹩脚的翻译

# Introduction

Voronoi图在计算几何中有着广泛的应用和扩充,Power图作为Voronoi图的重要扩展,它给站点site引入了权重这个特性,并且重新定义了距离.通过利用容量限制给普通的power图们就可以得到容量限制的Power图(CCPD),通过在二次基础上(secondary basis)引入质心约束(centroidal constraint),就可以得到质心容量限制的Power图(CCCPD).相较于Vorionoi图,由于权重的特性,Power图有更精确的容量约束的特性.因此Power图有着更加广泛的应用比如 blue noise sampling(蓝噪声采样), mesh optimization(网格优化), fluid simulation, computer animation, location-allocation proeblem, sector division, and grain structure representation of polucrystyalline materials, etc.

Aurenhammer等人首先引入了power图的概念性质计算方法和应用.Imai等人总结了平面Power图的理论和应用.Gavrilova等人构建了基于二维power图的power图.然而,在这些研究中,容量优化的问题被忽略了.

容量是Power图和重要的一个特性,最近,大量的研究者聚焦在研究能够得到满足容量限制的power图的计算方法上.Balzer等人首先提出了针对离散空间和连续空间的容量限制Power图的生成算法.这个算法结合了错误位置逐个迭代和Lloy方法得到稳定的CCCPD(质心容量限制Power图).然而,由于这种逐个点的迭代策略这个算法从计算CCCPD过程的角度来看是非常的耗费时间的.

de Gose等人使用牛顿算法优结合Mullen等人为优化站点提出的合适步长梯度下降方法和可替代的迭代获得的CCCPD的优化权重.然而在优化过程中的权重优化和站点优化界面只有线性集中.Bourne等人提出了一种广义的方法来计算质心Power图(CPD_并且理论上证明了他的线性约束.Xin等人发展了一种有着超级线性约束的L-BFGS方法来计算具有一般距离的CCCPD,并且将它应用在blue noise sampling, displacement interpolation and polygon convex decomposition(多边形凸分解).

最近几年,郑等人提出了一个GPU-CPU算法来加速计算power图,这个算法用基于GPU的JFA算法渲染和构建POWER图,然后联系L-BFGS方法来得到CCCPD,相较于目前对现今的纯CPU功率图计算方法相比，该方法在Power图的计算效率上有了显著的提高．

在现有的Power研究中,所有站点的容量约束预设值都是固定的,每个站点的容量域CCCPD中各自的预设值近似,然而,由于难以为所有站点设置精确的容量约束值,在一些实际应用中可能存在一些具有容量约束间隔的站点,如位置分配问题(LAP),其中混合容量约束是必须考虑的,据我们所知.本文是对具有混合容量约束Power图的首次研究,为此,我们提出了一种计算混合容量约束下CPD的迭代算法,本工作的主要贡献如下:

结合固定值的容量约束和间隔容量约束,得到一种新的power图,成为混合容量约束Power图(HCCPD),通过在二次基础上施加质心约束,得到混合质心容量约束Power图(HCCCPD)

通过间隔容量约束发展出一种权重评估方法用来优化站点的权重,并提出了一种可变容量约束Power图(VCCPD)

通过牛顿和Lloyd方法的耦合,提出了高效的用以计算HCCCPD的方法.

下面这一段文字取自另外一篇论文

通过以上定义,可以知道Voronoi图有以下性质:

1.对于二维平面中n个站点,Voronoi图将平面划分成n个区域,每个区域都包含一个唯一的站点

2.站点的Voronoi区域若为无界区域则该站点必然在站点集形成的**凸包边界**上;若为有界区域,该站点必然在凸包内部,且形成的Voronoi区域必然是凸多边形

3.Voronoi区域的边界为一条线或者一条射线.

4.对于有n个站点的Voronoi图至多有2*n-5个顶点,3*n-6条边

5.每个Voronoi点恰好是三条Voronoi边的交点(假设任何四点都不共圆的话).也就是说Voronoi点就是形成三边的三点的外接圆圆心,而且所有的这些外接圆有个特点:各自内部不含任何平面点集的点(空心圆).





凸包的解释:

凸包(Convex Hull)是一个计算几何中的概念

在一个实数向量空间V中,对于给定几何X,所有包含X的凸集的交集S被成为X的凸包.

X的凸包可以用X内所有点(X1,...Xn)的线性组合来构造

在二维欧几里得空间中,凸包可以想象为一条刚好包着所有点的橡皮圈,用不严谨的话来讲给定二维平面上的点集,凸包就是将最外层的点连接起来构成的凸多边形,它能包含点集中所有的点,

举例:假设平面上有p0~p12共13个点,过某些点做一个多边形,使这个多边形能把所有点都包起来,当这个多边形是凸多边形的时候,我们就叫它"凸包".如下图

![](https://img-blog.csdn.net/20150529181415457)

对于Voronoi图的生成算法,存在扫描线法和离散构造法等经典算法.而应用最广泛的,则是通过构造Delaunay三角化的对偶图生成Voronoi图.三角部分:假设二维实数域上的点集V={vi|i=1,2,...,n},Ev为点集中的点作为端点构成的线段,则对点集V的三角化可以表示为T=(V,Ev)是一个平面图G ,则该图满足以下条件:

1)除了端点,平面图中的边不包含几何中的其他点.

2)图中的边互不相交

3)平面图是有若干个三角面构成的,且所有三角面的并集是站点集V的凸包.





Voronoi图和Delaunay三角剖分的对偶关系:Voronoi图的一个顶点同时属于三个Voronoi多边形,每个Voroni多边形内有且仅有一个节站点.连接三个共点的Voronoi多边形分别对应的三个站点,形成一个Delaunay三角形,所有这样的三角形的集合就是Delaunay三角剖分

![](https://img-blog.csdn.net/20160712105919637?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

Delaunay三角剖分的定义

定义1.假设V是二维实数域上的有限点集,边e是由点集中的点作为端点构成的封闭线段,E为e的集合.那么该点集V的一个三角部分T=(V,E)是一个平面图G,该平面满足的条件:

1.除了端点,平面图中的边不包含点集中的任何点

2.没有相交边

3.平面中所有的面都是三角面,且所有三角面的合集就是点集V的凸包.

定义2.Delaunay边:假设E中的一条边e(两个端点为a,b),e若满足下列条件,则称之为Delaunay边.存在一个圆经过a,b两点,圆内不含点集V中任何的点,这一特性又称为空圆特性

定义3：如果点集V的一个三角剖分T只包含Delaunay边，那么该三角剖分称为Delaunay三角剖分。

 

Delaunay三角剖分所具备的优良特性：

（1）最接近性：点集中最接近的两点必会形成一条Delaunay边。

（2）唯一性：不论剖分过程如何，最终都将得到一样的结果（超过三点共圆的退化情况除外）。

（3）局部最优性：任意两个相邻的三角形如果形成凸四边形，且对角线可以互换，那么两个三角形六个内角中最小的角度不会变大。

（4）最小角最大：如果将同一点集的所有三角剖分中的每个每个三角形的最小角进行升序排列，则Delaunay三角剖分的排列按字典序最大。

（5）变动的局部性：新增、删除、移动某一个点时只会影响附近的三角形。

（6）具有凸包：Delaunay三角剖分的边界形成一个凸包。


# Priliminary

在本节中我们介绍一些Power图的相关概念







CCCPD

由于每个站点都引入了权重,Power图具有精确容量约束的特征,通过





# Power图的扫描生成算法

生成Power图的方法,无论是传统的正则三角构造法还是现在流行的离散生成法,尽管算法各异,但总的来说不论从程序设计思路还是数据结构等方面都相当复杂.因此选择一种思路简洁,结构简单,效率较高,且保证图形效果,也适用于高阶Power图的算法

由Power图的定义以及性质可知,Power边是由到相邻两生成元(Site)的Power距离相等的点构成,将这些点逐个画出,则可直接生成Power图.具体做法是:

1. 对于屏幕上任意像素点p,分别计算出p到n个生成元p1,p2,...,pn的Power距离
2. 从这n个Power距离中,取出最小值和次最小值.如果这两个Power距离之差的绝对值小于事先制定的某阈值,便将该点p画出,否则跳过该像素点,处理下一个像素点.

当p从上到下,从左到右遍历屏幕上的所有像素点,便得到了Power图

### 扫描生成算法描述:

输入:生成元集合S={$p_1,p_2,....,p_n$},权重集合W={w_1,w_2,...,w_n},其中wi为站点pi的权重

输出:以S为站点集,W为权重集的Power图

1. 画出n个站点site

2. 定义数组min[2]和p_min[2]

3. i=0,j=0

4. 求屏幕上坐标为(i,j)的像素点p与站点pi之间的power距离

   d(p,pi)=p和pi之间的欧式距离的平方-wi

   经过逐个比较,取前两个较小值依次赋给min[0],min[1],同时记录对应这两个Power距离的站点p_min[0],p_min[1]

5. 计算M(M在后文中有提到),如果|min[0]-min[1]|<Delta+M(Delta为事先指定的一个小正数,用来控制线的宽度,将Delta+M作为阈值_,便将该点p(i,j)画出,否则不画

6. j=j+1,如果j<=YMax(屏幕纵坐标最大值),转4;否则,转7;

7. i=i+1,如果i<=XMax(屏幕横坐标最大值),转3;否则,结束

### 算法中两个重要影响因素

Power边上任意点到相邻两生成元的Power距离差的绝对值与这两个Site之间的距离大小有关.

先看两生成元P1,P2的纵坐标相同时,的特殊情况.假设他们的权值是w1,w2,P为P1,P2间Power边上的任意一点.设它们的坐标分别为P(x,y),P1(x1,y1),P2(x2,y1),不妨设w1>0,w2>0(若不然,可以转换成这种情况?)

则P到两生成元P1,P2之间的Power距离的差的绝对值:

M=|dw(p,p1)-dw(p,p2)|

=|p到p1的power距离-p到p2的power距离|

=

# 改进的Power图快速及算法















# 如何应用到户型布局中



