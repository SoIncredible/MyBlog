---
title: 飞书协同工作流
abbrlink: 9891b583
date: 2025-01-12 21:30:16
tags:
categories:
cover: https://www.notion.so/images/page-cover/rijksmuseum_jansz_1641.jpg
description:
swiper_index:
sticky:
---

# Jenkins安装

在Mac上,使用Homebrew命令安装Jenkins
```shell
brew install jenkins-lts
```
安装成功后使用下面命令启动Jenkins服务器
```shell
brew services start jenkins-lts
```
在本地


其他常用命令
```shell
brew services restart jenkins-lts // 重启Jenkins
brew upgrade jenkins-lts // 升级Jenkins
```

Jenkins中的其他概念.

Node
Agent
创建Pipeline类型的Work无法看到workspace

通过新建一个Node的方式,并在pipeline流水线中制定,

# 遇到的问题

使用homebrew安装了java,在终端中运行Java提示`The operation couldn’t be completed. Unable to locate a Java Runtime.
Please visit http://www.java.com for information on installing Java.`
原因可能是使用homebrew安装的java没有jvm,需要去[java官网](https://www.oracle.com/java/technologies/downloads/#jdk23-mac)手动安装


# Jenkins执行成功/失败上报飞书


飞书+Luban使用 

问题记录

Arm版本的MacOS上使用.Net9并不行
需要使用.Net8


抖音小游戏SDK
https://bytedance.larkoffice.com/docx/doxcnTom4J47auHMnkjGYMBaNnZ
SDK使用文档
https://bytedance.larkoffice.com/docx/Pu56d7eWfo53PaxizyNcOsxXnBe


# Unity更新飞书文档



```shell
#!/bin/bash

Total=$#
svnPath=$1
DingDingRobot=$2
Channels=$3;
ServerMode=$4;
GameName=$5;
ClientId=$6;
IntClientId=$7;
VersionName=$8;
VersionCode=$9;
Lebian_ClientChId=$10;
Environment=${11};
IgnoreAD=${12};
ScriptBackend=${13};
Architetures=${14};
Hall37SvnUrl=${15};
OutputDir=${16};
FenbaoId=${17};
IsIncludeAd=${18};
IsRemovePermission=${19};
IsRemoveUnityProject=${20};
SdkParams=${21};
UseLocalCdn=${22};
LogOpen=${23};
OnlyPackRes=${24};
ProjectType="DDZ"
if (( Total > 24 )); then
	ProjectType=${25};
	echo jenkinsco_New--param25--${25}
fi


echo "Hall37SvnUrl  :$Hall37SvnUrl"
echo "OutputDir  :$OutputDir"

echo "FenbaoId  :$FenbaoId"
echo "IsIncludeAd  :$IsIncludeAd"

echo "IsRemovePermission  :$IsRemovePermission"
echo "IsRemoveUnityProject  :$IsRemoveUnityProject"

echo "SdkParams  :$SdkParams"
echo "UseLocalCdn  :$UseLocalCdn"


targetPathRoot=/Users/cluo/.jenkins/workspace
jobName=$JOB_NAME
targetTurePath=$targetPathRoot/$jobName
svnDir=$targetTurePath/.svn
conpareChar="|"


if [[ $IsRemoveUnityProject == true ]]; then
	echo "清理工程目录"
	
	if [[ ! -d $targetTurePath ]]; then
		mkdir $targetTurePath
	fi
	cd $targetTurePath
	
	if [[ ! -d $svnDir ]]; then
		echo "svn check out"
		svn co $svnPath $targetTurePath --username zhangjinyang@tuyoogame.com --password Aq279898123@ #--quiet
	else
		svn cleanup $targetTurePath
		echo "svn up"
		svn revert $targetTurePath -R --username zhangjinyang@tuyoogame.com --password Aq279898123@ #--quiet
		svn up $targetTurePath --username zhangjinyang@tuyoogame.com --password Aq279898123@ #--quiet
	fi
	
	DIR=$(pwd);
	echo $DIR
else
	echo "不移除工程"
fi

#svn path无需传递 参数减1传递
sh buildAndroidWithHall37.sh $DingDingRobot ${Channels} ${ServerMode} ${GameName} ${ClientId} ${IntClientId} ${VersionName} ${VersionCode} ${Lebian_ClientChId} ${Environment} ${IgnoreAD} ${ScriptBackend} ${Architetures} ${Hall37SvnUrl} ${OutputDir} ${FenbaoId} ${IsIncludeAd} ${IsRemovePermission} ${IsRemoveUnityProject} "${SdkParams}" ${UseLocalCdn} ${LogOpen} ${OnlyPackRes} ${ProjectType}

#40打包机器是测试打包机不需要备份svn 注释掉
# if [[ "$jobName" == "DDZ_release" ]]; then
# 	if [[ "$ServerMode" == "Zsf" ]]; then
# 		sourceUrl=${svnPath%\/doudizhu*}
# 		echo sourceUrl: $sourceUrl
# 		targetUrl=`echo $sourceUrl | sed -e "s/branches\/build_android/tags\/build_android_${VersionName}/g"`
# 		echo targetUrl: $targetUrl
# 		svn delete -m '删除存在的分支 tag DDZ_Android_${VersionName}' $targetUrl
# 		svn cp -m '备份: DDZ_Android_${VersionName} tag' $sourceUrl $targetUrl

# 		sh tools/uploadLibrary.sh ${ServerMode} ${VersionName} ${svnPath} ${targetTurePath} "Android"
# 	fi
# fi
```